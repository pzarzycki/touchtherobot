<html>

<head>

</head>

<body style="background: #eee;">
    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="https://mpld3.github.io/js/mpld3.v0.2.js"></script>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 11pt;
            margin: 0px;
            margin-top: 36px;
        }
        
        #header {
            display: block;
            position: fixed;
            z-index: 100;
            background: #ccc;
            width: 100%;
            margin: 0px;
            padding: 10px;
            top: 0px;
        }
        
        .msg {
            position: relative;
            top: 40%;
            color: #666;
            margin: 20px;
        }
        
        .explain {
            display: inline-block;
            margin-left: 40px;
        }
        
        .title {
            font-weight: bold;
        }
        
        .loading {
            color: #666;
            margin: 20px;
        }
    </style>
    <div id="header">
        <label for="person">Person:</label>
        <select name="person" id="person"></select>
        <div class="explain">A1-A11: Names ('Napisy'), B1-B11: Numbers ('Cyfry')</div>
    </div>

    <div id="plot" style="width: 100%; height: 100%; text-align: center;"></div>


    <script type="text/javascript">
        fetch('all_indexes.json')
            .then(response => response.text())
            .then(text => {

                ids = JSON.parse(text);
                var x = document.getElementById("person");

                for (idx in ids.ids) {
                    var option = document.createElement("option");
                    option.text = ids.ids[idx];
                    x.add(option);
                }

                x.addEventListener('change', (event) => {
                    const id = event.target.value;
                    loadPlot(id);
                });

                loadPlot(ids.ids[0]);

            });

        function loadPlot(personId) {
            var plotDiv = document.getElementById("plot");
            plotDiv.innerHTML = "<div class='msg'>loading...</div>";

            var plotDiv = document.getElementById("plot");
            //plotDiv.innerHTML = "<div class='title'>Subsequence 1</div><div id='fig01'>loading...</div><div class='title'>Subsequence 2</div><div id='fig02'>loading...</div><div class='title'>Subsequence 3</div><div id='fig03'>loading...</div>";
            plotDiv.innerHTML = "<div id='fig01'><div class='loading'>loading...</div></div><div class='title'>Subsequence 1</div><div id='fig02'><div class='loading'>loading...</div></div><div class='title'>Subsequence 2</div><div id='fig03'><div class='loading'>loading...</div></div><div class='title'>Subsequence 3</div>";

            loadSinglePlot("plots/plot_" + personId + "_0.json", "fig01");
            loadSinglePlot("plots/plot_" + personId + "_1.json", "fig02");
            loadSinglePlot("plots/plot_" + personId + "_2.json", "fig03");

        }

        function loadSinglePlot(jsonDataName, figElementName) {
            fetch(jsonDataName)
                .then(response => response.text())
                .then(text => {
                    var figDiv = document.getElementById(figElementName);
                    figDiv.innerHTML = "";

                    var H = document.body.scrollHeight;
                    var W = document.body.scrollWidth;

                    fig = JSON.parse(text);
                    fig.width = W * 0.95;
                    fig.height = H * 0.9;

                    mpld3.draw_figure(figElementName, fig);
                }).catch(function() {
                    var figDiv = document.getElementById(figElementName);
                    figDiv.innerHTML = "<div class='msg'>Can not load data here </div>";
                });
        }

        // mpld3.draw_figure("fig02", json02);
        // mpld3.draw_figure("fig03", json03);
    </script>
</body>

</html>